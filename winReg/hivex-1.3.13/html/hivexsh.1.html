<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<link rel="stylesheet" href="pod.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#OPTIONS">OPTIONS</a></li>
  <li><a href="#COMMANDS">COMMANDS</a></li>
  <li><a href="#EXAMPLE">EXAMPLE</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#AUTHORS">AUTHORS</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>hivexsh - Windows Registry hive shell</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code> hivexsh [-options] [hivefile]</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This program provides a simple shell for navigating Windows Registry &#39;hive&#39; files. It uses the hivex library for access to these binary files.</p>

<p>Firstly you will need to provide a hive file from a Windows operating system. The hive files are usually located in <code>C:\Windows\System32\Config</code> and have names like <code>software</code>, <code>system</code> etc (without any file extension). For more information about hive files, read <a href="http://man.he.net/man3/hivex">hivex(3)</a>. For information about downloading files from virtual machines, read <a href="http://man.he.net/man1/virt-cat">virt-cat(1)</a> and <a href="http://man.he.net/man1/guestfish">guestfish(1)</a>.</p>

<p>You can provide the name of the hive file to examine on the command line. For example:</p>

<pre><code> hivexsh software</code></pre>

<p>Or you can start <code>hivexsh</code> without any arguments, and immediately use the <code>load</code> command to load a hive:</p>

<pre><code> $ hivexsh

 Welcome to hivexsh, the hivex interactive shell for examining
 Windows Registry binary hive files.

 Type: &#39;help&#39; for help with commands
       &#39;quit&#39; to quit the shell

 &gt; load software
 software\&gt;</code></pre>

<p>Navigate through the hive&#39;s keys using the <code>cd</code> command, as if it contained a filesystem, and use <code>ls</code> to list the subkeys of the current key. Other commands are listed below.</p>

<h1 id="OPTIONS">OPTIONS</h1>

<dl>

<dt id="d"><b>-d</b></dt>
<dd>

<p>Enable lots of debug messages. If you find a Registry file that this program cannot parse, please enable this option and post the complete output <i>and</i> the Registry hive file in your bug report.</p>

</dd>
<dt id="f-filename"><b>-f</b> filename</dt>
<dd>

<p>Read commands from <code>filename</code> instead of stdin. To write a hivexsh script, use:</p>

<pre><code> #!/usr/bin/hivexsh -f</code></pre>

</dd>
<dt id="w"><b>-w</b></dt>
<dd>

<p>If this option is given, then writes are allowed to the hive (see <a href="#commit">&quot;commit&quot;</a> command below, and the discussion of modifying hives in <a href="http://man.he.net/man3/hivex">&quot;WRITING TO HIVE FILES&quot; in hivex(3)</a>).</p>

<p><b>Important Note:</b> Even if you specify this option, nothing is written to a hive unless you call the <a href="#commit">&quot;commit&quot;</a> command. If you exit the shell without committing, all changes will be discarded.</p>

<p>If this option is not given, then write commands are disabled.</p>

</dd>
</dl>

<h1 id="COMMANDS">COMMANDS</h1>

<dl>

<dt id="add-name"><b>add</b> name</dt>
<dd>

<p>Add a subkey named <code>name</code> below the current node. The name may contain spaces and punctuation characters, and does not need to be quoted.</p>

<p>The new key will have no subkeys and no values (see <code>setval</code>).</p>

<p>There must be no existing subkey called <code>name</code>, or this command will fail. To replace an existing subkey, delete it first like this:</p>

<pre><code> cd name
 del</code></pre>

</dd>
<dt id="cd-path"><b>cd</b> path</dt>
<dd>

<p>Change to the subkey <code>path</code>. Use Windows-style backslashes to separate path elements, and start with a backslash in order to start from the root of the hive. For example:</p>

<pre><code> cd \Classes\*</code></pre>

<p>moves from the root node, to the <code>Classes</code> node, to the <code>*</code> node. If you were already at the root node, you could do this instead:</p>

<pre><code> cd Classes\*</code></pre>

<p>or even:</p>

<pre><code> cd Classes
 cd *</code></pre>

<p>Path elements (node names) are matched case insensitively, and characters like space, <code>*</code>, and <code>?</code> have <i>no</i> special significance.</p>

<p><code>cd ..</code> may be used to go to the parent directory.</p>

<p><code>cd</code> without any arguments prints the current path.</p>

<p>Be careful with <code>cd \</code> since the readline library has an undocumented behaviour where it will think the final backslash is a continuation (it reads the next line of input and appends it). Put a single space after the backslash.</p>

</dd>
<dt id="close-unload"><b>close</b> | <b>unload</b></dt>
<dd>

<p>Close the currently loaded hive.</p>

<p>If you modified the hive, all uncommitted writes are lost when you call this command (or if the shell exits). You have to call <code>commit</code> to write changes.</p>

</dd>
<dt id="commit-newfile"><b>commit</b> [newfile]</dt>
<dd>

<p>Commit changes to the hive. If the optional <code>newfile</code> parameter is supplied, then the hive is written to that file, else the original file is overwritten.</p>

<p>Note that you have to specify the <code>-w</code> flag, otherwise no writes are allowed.</p>

</dd>
<dt id="del"><b>del</b></dt>
<dd>

<p>Delete the current node and everything beneath it. The current directory is moved up one level (as if you did <code>cd ..</code>) after this command.</p>

<p>You cannot delete the root node.</p>

</dd>
<dt id="exit-quit"><b>exit</b> | <b>quit</b></dt>
<dd>

<p>Exit the shell.</p>

</dd>
<dt id="load-hivefile"><b>load</b> hivefile</dt>
<dd>

<p>Load the binary hive named <code>hivefile</code>. The currently loaded hive, if any, is closed. The current directory is changed back to the root node.</p>

</dd>
<dt id="ls"><b>ls</b></dt>
<dd>

<p>List the subkeys of the current hive Registry key. Note this command does not take any arguments.</p>

</dd>
<dt id="lsval-key"><b>lsval</b> [key]</dt>
<dd>

<p>List the (key, value) pairs of the current hive Registry key. If no argument is given then all pairs are displayed. If <code>key</code> is given, then the value of the named key is displayed. If <code>@</code> is given, then the value of the default key is displayed.</p>

</dd>
<dt id="setval-nrvals"><b>setval</b> nrvals</dt>
<dd>

<p>This command replaces all (key, value) pairs at the current node with the values in subsequent input. <code>nrvals</code> is the number of values (ie. (key, value) pairs), and any existing values at this node are deleted. So <code>setval 0</code> just deletes any values at the current node.</p>

<p>The command reads 2 * nrvals lines of input, with each pair of lines of input corresponding to a key and a value to add.</p>

<p>For example, the following setval command replaces whatever is at the current node with two (key, value) pairs. The default key is set to the UTF16-LE-encoded string &quot;abcd&quot;. The other value is named &quot;ANumber&quot; and is a little-endian DWORD 0x12345678.</p>

<pre><code> setval 2
 @
 string:abcd
 ANumber
 dword:12345678</code></pre>

<p>The first line of each pair is the key (the special key <code>@</code> means the default key, but you can also use a blank line).</p>

<p>The second line of each pair is the value, which has a special format <code>type:value</code> with possible types summarized in the table below:</p>

<pre><code> none                 No data is stored, and the type is set to 0.

 string:abc           &quot;abc&quot; is stored as a UTF16-LE-encoded
                      string (type 1).  Note that only 7 bit
                      ASCII strings are supported as input.

 expandstring:...     Same as string but with type 2.

 dword:0x01234567     A DWORD (type 4) with the hex value
                      0x01234567.  You can also use decimal
                      or octal numbers here.

 qword:0x0123456789abcdef
                      A QWORD (type 11) with the hex value
                      0x0123456789abcdef.  You can also use
                      decimal or octal numbers here.

 hex:&lt;type&gt;:&lt;hexbytes&gt;
 hex:1:41,00,42,00,43,00,44,00,00,00
                      This is the generic way to enter any
                      value.  &lt;type&gt; is the integer value type.
                      &lt;hexbytes&gt; is a list of pairs of hex
                      digits which are treated as bytes.
                      (Any non-hex-digits here are ignored,
                      so you can separate bytes with commas
                      or spaces if you want).</code></pre>

</dd>
</dl>

<h1 id="EXAMPLE">EXAMPLE</h1>

<pre><code> $ guestfish --ro -i Windows7
 &gt;&lt;fs&gt; download win:c:\windows\system32\config\software software
 &gt;&lt;fs&gt; quit

 $ hivexsh software

 Welcome to hivexsh, the hivex interactive shell for examining
 Windows Registry binary hive files.

 Type: &#39;help&#39; for help with commands
       &#39;quit&#39; to quit the shell

 software\&gt; ls
 ATI Technologies
 Classes
 Clients
 Intel
 Microsoft
 ODBC
 Policies
 RegisteredApplications
 Sonic
 Wow6432Node
 software\&gt; quit</code></pre>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a href="http://man.he.net/man3/hivex">hivex(3)</a>, <a href="http://man.he.net/man1/hivexget">hivexget(1)</a>, <a href="http://man.he.net/man1/hivexml">hivexml(1)</a>, <a href="http://man.he.net/man1/virt-win-reg">virt-win-reg(1)</a>, <a href="http://man.he.net/man3/guestfs">guestfs(3)</a>, <a href="http://libguestfs.org/">http://libguestfs.org/</a>, <a href="http://man.he.net/man1/virt-cat">virt-cat(1)</a>, <a href="http://man.he.net/man1/virt-edit">virt-edit(1)</a>.</p>

<h1 id="AUTHORS">AUTHORS</h1>

<p>Richard W.M. Jones (<code>rjones at redhat dot com</code>)</p>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright (C) 2009-2010 Red Hat Inc.</p>

<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>

<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>

<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</p>


</body>

</html>


